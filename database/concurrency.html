<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Concurrency Issues Interactive Demo | Fullstackgada</title>
  <meta name="description" content="Explore concurrency issues with an interactive demo! Learn about race conditions, locking mechanisms, and solutions like pessimistic and optimistic locking.">
  <meta name="author" content="Fullstackgada">
  <meta name="robots" content="index, follow">

  <!-- Canonical -->
  <link rel="canonical" href="https://fullstackgada.netlify.app/database/concurrency">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="/image/favicon.ico">

  <!-- Styles -->
  <link rel="stylesheet" href="/interactive-demo.css">
  <link rel="preload" href="/interactive-demo.css" as="style">

  <!-- Open Graph Tags -->
  <meta property="og:title" content="Concurrency Issues Interactive Demo | Fullstackgada">
  <meta property="og:description" content="Discover concurrency issues with an interactive demo! Learn race conditions, locking mechanisms, and solutions like pessimistic and optimistic locking.">
  <meta property="og:url" content="https://fullstackgada.netlify.app/database/concurrency">
  <meta property="og:type" content="article">
  <meta property="og:image" content="https://fullstackgada.netlify.app/database/images/concurrency.webp">

  <!-- Twitter Card Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Concurrency Issues Interactive Demo | Fullstackgada">
  <meta name="twitter:description" content="Learn concurrency issues with an interactive demo, covering race conditions, locking mechanisms, and solutions.">
  <meta name="twitter:image" content="https://fullstackgada.netlify.app/database/images/concurrency.webp">

  <!-- Article Schema Markup -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "Concurrency Issues Interactive Demo",
    "description": "Explore concurrency issues with an interactive demo, covering race conditions, locking mechanisms, and solutions like pessimistic and optimistic locking.",
    "author": {
      "@type": "Person",
      "name": "Fullstackgada"
    },
    "url": "https://fullstackgada.netlify.app/database/concurrency",
    "datePublished": "2025-09-13",
    "dateModified": "2025-09-13",
    "publisher": {
      "@type": "Organization",
      "name": "Fullstackgada",
      "logo": {
        "@type": "ImageObject",
        "url": "https://fullstackgada.netlify.app/image/favicon.ico"
      }
    }
  }
  </script>

  <!-- FAQ Schema Markup -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "What are concurrency issues in databases?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Concurrency issues occur when multiple transactions try to access or modify the same data simultaneously, leading to problems like race conditions, dirty reads, lost updates, and inconsistent states."
        }
      },
      {
        "@type": "Question",
        "name": "What is pessimistic locking?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Pessimistic locking prevents conflicts by locking the data until a transaction is completed. This ensures data consistency but may reduce performance due to blocking other transactions."
        }
      },
      {
        "@type": "Question",
        "name": "What is optimistic locking?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Optimistic locking assumes conflicts are rare. Instead of locking data, it checks for changes before committing a transaction. If a conflict is detected, the transaction is retried, making it more efficient in read-heavy systems."
        }
      }
    ]
  }
  </script>
</head>

<body>
    <div class="container">
        <!-- Header -->
        <div class="header-interactive" style="position:relative;">
            <h1>Concurrency Issues Interactive Demo</h1>
            <p>Master concurrency issues with FullstackGada‚Äôs fun approach! ‚ö°</p>
            <div class="explore-diagrams-btn-wrapper">
                <a href="/interactive.html" class="explore-diagrams-btn">
                    <img src="/image/plus-circle.svg" alt="Explore more diagrams"> More Diagrams
                </a>
            </div>
            <div class="follow-btn-wrapper">
                <a href="https://www.instagram.com/fullstackgada" target="_blank" class="follow-btn">
                    <img src="/image/instagram.svg" alt="Follow FullstackGada on Instagram"> Follow for More
                </a>
            </div>
        </div>

        <!-- Demo Grid -->
        <div class="demo-grid">
            <!-- Concurrency Problem Simulator -->
            <div class="demo-section">
                <h2 class="demo-title">‚ö° Concurrency Problem Simulator</h2>
                <div class="explanation">
                    <strong>Problem:</strong> Two users trying to buy the same product simultaneously!
                </div>

                <!-- Product Stock Display -->
                <div class="demo-area" id="stockDisplay">
                    <div class="event-message one-message">
                        <strong>üì± iPhone 15 Pro</strong><br>
                        <strong>Stock Available:</strong> <span id="currentStock">1</span><br>
                        <strong>Price:</strong> $1,499
                    </div>
                </div>

                <!-- User Simulation Controls -->
                <div class="demo-controls">
                    <button class="demo-btn first-btn" onclick="simulateNormalPurchase()" role="button" aria-label="Simulate Normal Purchase">
                        ‚úÖ Normal Purchase (No Concurrency)
                    </button>
                    <button class="demo-btn" onclick="simulateConcurrencyIssue()" role="button" aria-label="Simulate Concurrency Issue">
                        ‚ö†Ô∏è Simulate Concurrency Issue
                    </button>
                    <button class="demo-btn" onclick="simulateWithLocking()" role="button" aria-label="Simulate Purchase with Locking">
                        üîí Purchase with Locking
                    </button>
                    <button class="demo-btn clear-btn" onclick="resetStock()" role="button" aria-label="Reset Stock">
                        üîÑ Reset Stock
                    </button>
                </div>

                <!-- Purchase Logs -->
                <div class="server-simulation">
                    <h4>Purchase Logs:</h4>
                    <div class="server-log" id="purchaseLogs">
                        Ready to simulate purchases...
                    </div>
                </div>
            </div>

            <!-- Solutions Demonstration -->
            <div class="demo-section">
                <h2 class="demo-title">üõ°Ô∏è Concurrency Solutions</h2>
                <div class="explanation one-explanation">
                    <strong>Solutions:</strong> Techniques to handle concurrent access effectively.
                </div>

                <!-- Solution Tabs -->
                <div class="tabs">
                    <button class="tab active" onclick="showSolution('locking')" role="button" aria-label="Show Locking Solution">üîí Locking</button>
                    <button class="tab" onclick="showSolution('optimistic')" role="button" aria-label="Show Optimistic Locking Solution">üéØ Optimistic</button>
                    <button class="tab" onclick="showSolution('atomic')" role="button" aria-label="Show Atomic Transactions Solution">‚öõÔ∏è Atomic</button>
                    <button class="tab" onclick="showSolution('ui-handling')" role="button" aria-label="Show UI Handling Solution">üñ•Ô∏è UI Handling</button>
                </div>

                <!-- Solution Content -->
                <div id="locking" class="tab-content active">
                    <div class="code-block">
                        <div class="code-line comment">-- Pessimistic Locking Approach</div>
                        <div class="code-line var-declaration">BEGIN TRANSACTION</div>
                        <div class="code-line var-usage">SELECT stock FROM products WHERE id = 1 FOR UPDATE;</div>
                        <div class="code-line var-assignment">-- Row is now locked, other users must wait</div>
                        <div class="code-line var-usage">IF stock > 0 THEN</div>
                        <div class="code-line var-usage">  UPDATE products SET stock = stock - 1 WHERE id = 1;</div>
                        <div class="code-line var-usage">  INSERT INTO orders (user_id, product_id) VALUES (?, ?);</div>
                        <div class="code-line var-declaration">COMMIT;</div>
                    </div>
                    <div class="explanation">
                        <strong>Advantage:</strong> Guaranteed consistency<br>
                        <strong>Disadvantage:</strong> Performance impact, potential deadlocks
                    </div>
                </div>

                <div id="optimistic" class="tab-content">
                    <div class="code-block">
                        <div class="code-line comment">-- Optimistic Concurrency Control</div>
                        <div class="code-line var-declaration">SELECT stock, version FROM products WHERE id = 1;</div>
                        <div class="code-line var-assignment">-- Client performs business logic</div>
                        <div class="code-line var-usage">UPDATE products SET</div>
                        <div class="code-line var-usage">  stock = stock - 1,</div>
                        <div class="code-line var-usage">  version = version + 1</div>
                        <div class="code-line var-usage">WHERE id = 1 AND version = @original_version;</div>
                        <div class="code-line var-assignment">-- If affected rows = 0, then conflict occurred</div>
                    </div>
                    <div class="explanation">
                        <strong>Advantage:</strong> Better performance, no blocking<br>
                        <strong>Disadvantage:</strong> Retry logic needed
                    </div>
                </div>

                <div id="atomic" class="tab-content">
                    <div class="code-block">
                        <div class="code-line comment">-- Atomic Transaction</div>
                        <div class="code-line var-declaration">CREATE PROCEDURE BuyProduct(@userId INT, @productId INT)</div>
                        <div class="code-line var-declaration">AS BEGIN</div>
                        <div class="code-line var-usage">  BEGIN TRANSACTION</div>
                        <div class="code-line var-usage">  DECLARE @stock INT</div>
                        <div class="code-line var-usage">  SELECT @stock = stock FROM products WHERE id = @productId</div>
                        <div class="code-line var-usage">  IF @stock > 0</div>
                        <div class="code-line var-usage">    UPDATE products SET stock = stock - 1 WHERE id = @productId</div>
                        <div class="code-line var-usage">    INSERT INTO orders VALUES(@userId, @productId, GETDATE())</div>
                        <div class="code-line var-usage">    COMMIT</div>
                        <div class="code-line var-usage">  ELSE</div>
                        <div class="code-line var-usage">    ROLLBACK</div>
                        <div class="code-line var-declaration">END</div>
                    </div>
                </div>

                <div id="ui-handling" class="tab-content">
                    <div class="code-block">
                        <div class="code-line comment">// Frontend Concurrency Handling</div>
                        <div class="code-line var-declaration">let isProcessing = false;</div>
                        <div class="code-line var-declaration">function buyNow() {</div>
                        <div class="code-line var-usage">  if (isProcessing) return;</div>
                        <div class="code-line var-usage">  isProcessing = true;</div>
                        <div class="code-line var-usage">  document.getElementById('buyBtn').disabled = true;</div>
                        <div class="code-line var-usage">  fetch('/api/purchase', { method: 'POST' })</div>
                        <div class="code-line var-usage">    .then(response => {</div>
                        <div class="code-line var-usage">      isProcessing = false;</div>
                        <div class="code-line var-usage">      document.getElementById('buyBtn').disabled = false;</div>
                        <div class="code-line var-usage">    });</div>
                        <div class="code-line var-declaration">}</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Debug and Monitoring Section -->
        <div class="demo-section" style="grid-column: 1 / -1;">
            <h2 class="demo-title">üîç Concurrency Debugging & Monitoring</h2>
            <div class="tabs">
                <button class="tab active" onclick="showTab('debug-logs')" role="button" aria-label="Show Debug Logs">üìã Debug Logs</button>
                <button class="tab" onclick="showTab('metrics')" role="button" aria-label="Show Metrics">üìä Metrics</button>
                <button class="tab" onclick="showTab('solutions-comparison')" role="button" aria-label="Show Solutions Comparison">‚öñÔ∏è Solutions Comparison</button>
            </div>

            <!-- Debug Logs Tab -->
            <div id="debug-logs" class="tab-content active">
                <h4>üïí Timestamp Analysis</h4>
                <div class="code-block" id="debugLogsDisplay">
                    <div class="code-line comment">/* Simulate purchases to see debug logs */</div>
                </div>
                <button class="demo-btn" onclick="generateDebugLogs()" role="button" aria-label="Generate Debug Logs">üîç Generate Debug Logs</button>
            </div>

            <!-- Metrics Tab -->
            <div id="metrics" class="tab-content">
                <h4>üìà Concurrency Metrics</h4>
                <table class="responsive-table">
                    <thead>
                        <tr>
                            <th>Metric</th>
                            <th>Without Protection</th>
                            <th>With Protection</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Success Rate</strong></td>
                            <td id="unprotectedSuccess">60%</td>
                            <td id="protectedSuccess">100%</td>
                        </tr>
                        <tr>
                            <td><strong>Data Integrity</strong></td>
                            <td id="unprotectedIntegrity">‚ùå Compromised</td>
                            <td id="protectedIntegrity">‚úÖ Maintained</td>
                        </tr>
                        <tr>
                            <td><strong>Response Time</strong></td>
                            <td id="unprotectedTime">150ms</td>
                            <td id="protectedTime">280ms</td>
                        </tr>
                        <tr>
                            <td><strong>Error Rate</strong></td>
                            <td id="unprotectedErrors">40%</td>
                            <td id="protectedErrors">0%</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Solutions Comparison Tab -->
            <div id="solutions-comparison" class="tab-content">
                <table class="comparison-table responsive-table">
                    <thead>
                        <tr>
                            <th>Solution</th>
                            <th>‚úÖ Pros</th>
                            <th>‚ùå Cons</th>
                            <th>Use Case</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>üîí Pessimistic Locking</strong></td>
                            <td>100% consistency guaranteed</td>
                            <td>Performance impact, deadlock risk</td>
                            <td>Critical operations, low concurrency</td>
                        </tr>
                        <tr>
                            <td><strong>üéØ Optimistic Locking</strong></td>
                            <td>Better performance, no blocking</td>
                            <td>Retry logic needed, conflict resolution</td>
                            <td>High read, low conflict scenarios</td>
                        </tr>
                        <tr>
                            <td><strong>‚öõÔ∏è Atomic Transactions</strong></td>
                            <td>ACID compliance, data integrity</td>
                            <td>Resource intensive</td>
                            <td>Financial transactions, inventory</td>
                        </tr>
                        <tr>
                            <td><strong>üñ•Ô∏è UI Controls</strong></td>
                            <td>User-friendly, immediate feedback</td>
                            <td>Client-side only, not foolproof</td>
                            <td>User experience enhancement</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        let currentStock = 1;
        let purchaseLog = [];

        // Simulate normal purchase
        function simulateNormalPurchase() {
            if (currentStock > 0) {
                currentStock--;
                const timestamp = new Date().toLocaleTimeString();
                purchaseLog.push(`${timestamp} - User 1: Purchase successful`);
                
                document.getElementById('currentStock').textContent = currentStock;
                document.getElementById('purchaseLogs').innerHTML = `
                    <strong style="color: #4caf50;">‚úÖ Purchase Successful</strong><br>
                    User 1 purchased iPhone 15 Pro<br>
                    Remaining Stock: ${currentStock}
                `;
            } else {
                document.getElementById('purchaseLogs').innerHTML = `
                    <strong style="color: #f56565;">‚ùå Out of Stock</strong><br>
                    Cannot process purchase - no stock available
                `;
            }
        }

        // Simulate concurrency issue
        function simulateConcurrencyIssue() {
            const timestamp = new Date().toLocaleTimeString();
            
            // Simulate two users accessing at the same time
            setTimeout(() => {
                purchaseLog.push(`${timestamp} - User 1: Checking stock (Stock: ${currentStock})`);
                purchaseLog.push(`${timestamp} - User 2: Checking stock (Stock: ${currentStock})`);
                
                // Both see stock as available
                if (currentStock > 0) {
                    purchaseLog.push(`${timestamp} - User 1: Stock available, proceeding...`);
                    purchaseLog.push(`${timestamp} - User 2: Stock available, proceeding...`);
                    
                    // Both try to purchase
                    setTimeout(() => {
                        currentStock--;
                        purchaseLog.push(`${timestamp} - User 1: Purchase successful`);
                        purchaseLog.push(`${timestamp} - User 2: Purchase successful`);
                        
                        document.getElementById('currentStock').textContent = currentStock;
                        document.getElementById('purchaseLogs').innerHTML = `
                            <strong style="color: #f56565;">‚ö†Ô∏è Concurrency Issue Detected!</strong><br>
                            Both users got success message but only 1 item was in stock!<br>
                            This leads to overselling and data inconsistency.<br>
                            <strong>Stock should be: 0, Actual orders: 2</strong>
                        `;
                    }, 100);
                }
            }, 50);
        }

        // Simulate purchase with locking
        function simulateWithLocking() {
            const timestamp = new Date().toLocaleTimeString();
            
            // Simulate locking mechanism
            setTimeout(() => {
                purchaseLog.push(`${timestamp} - User 1: Acquiring lock on product...`);
                purchaseLog.push(`${timestamp} - User 2: Waiting for lock...`);
                
                // First user gets the lock
                if (currentStock > 0) {
                    currentStock--;
                    purchaseLog.push(`${timestamp} - User 1: Lock acquired, purchase successful`);
                    purchaseLog.push(`${timestamp} - User 2: Lock acquired, but stock is 0 - purchase failed`);
                    
                    document.getElementById('currentStock').textContent = currentStock;
                    document.getElementById('purchaseLogs').innerHTML = `
                        <strong style="color: #4caf50;">‚úÖ Locking Mechanism Working</strong><br>
                        User 1: Purchase successful (got the lock first)<br>
                        User 2: Purchase failed (stock depleted)<br>
                        <strong>Data integrity maintained!</strong>
                    `;
                }
            }, 50);
        }

        // Reset stock
        function resetStock() {
            currentStock = 1;
            purchaseLog = [];
            document.getElementById('currentStock').textContent = currentStock;
            document.getElementById('purchaseLogs').innerHTML = 'Ready to simulate purchases...';
        }

        // Show solution tabs
        function showSolution(solutionName) {
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.remove('active'));
            
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            document.getElementById(solutionName).classList.add('active');
            event.target.classList.add('active');
        }

        // Generate debug logs
        function generateDebugLogs() {
            const debugDisplay = document.getElementById('debugLogsDisplay');
            const timestamp = new Date().toISOString();
            
            debugDisplay.innerHTML = `
                <div class="code-line">${timestamp} - [DEBUG] User 1 accessing product ID: 1</div>
                <div class="code-line">${timestamp} - [DEBUG] User 2 accessing product ID: 1</div>
                <div class="code-line">${timestamp} - [DEBUG] Current stock: 1</div>
                <div class="code-line">${timestamp} - [DEBUG] User 1: Stock check passed</div>
                <div class="code-line">${timestamp} - [DEBUG] User 2: Stock check passed (SAME TIME!)</div>
                <div class="code-line error">${timestamp} - [ERROR] Concurrency detected: Multiple users accessing same resource</div>
                <div class="code-line">${timestamp} - [DEBUG] User 1: Purchase successful</div>
                <div class="code-line">${timestamp} - [DEBUG] User 2: Purchase successful (PROBLEM!)</div>
                <div class="code-line error">${timestamp} - [ERROR] Data inconsistency: Stock oversold</div>
            `;
        }

        // Tab functionality for debug section
        function showTab(tabName) {
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.remove('active'));
            
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Initialize demo
        window.onload = function() {
            resetStock();
        };
    </script>
</body>
</html>