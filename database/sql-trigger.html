<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Triggers ka Funda - Fullstackgada ka Interactive Demo</title>
    <link rel="icon" type="image/png" href="/image/favicon.ico">
    <link rel="stylesheet" href="/interactive-demo.css">
</head>
<body>
    <div class="container"> 
        <!-- Header Section -->
        <div class="header-interactive" style="position:relative;">
            <h1>SQL Triggers ka Funda</h1>
            <p>Understand how SQL Triggers works with Fullstackgada</p>
            <div class="explore-diagrams-btn-wrapper">
            <a href="/interactive.html" class="explore-diagrams-btn">
                <img src="/image/plus-circle.svg" alt="Instagram icon"> More Diagrams
            </a>
        </div>
       <div class="follow-btn-wrapper">
            <a href="https://www.instagram.com/fullstackgada" target="_blank" class="follow-btn">
    <img src="/image/instagram.svg" alt="Instagram icon"> Follow for More
</a>
        </div>
        </div>

        <!-- Demo Grid -->
        <div class="demo-grid">
            <!-- Trigger Concepts -->
            <div class="demo-section">
                <h2 class="demo-title">‚è≥ Database Triggers ka Concept</h2>
                
                <div class="explanation">
                    <strong>Trigger</strong> ek automated action hai, jo database mein koi event (INSERT, UPDATE, DELETE) hone par apne-aap chal jati hai.
                </div>

                <!-- Trigger Control Buttons -->
                <div class="demo-controls">
                    <button class="demo-btn first-btn" onclick="showTriggerType('insert')">
                        üóìÔ∏è INSERT Trigger
                    </button>
                    <button class="demo-btn" onclick="showTriggerType('update')">
                        ‚úèÔ∏è UPDATE Trigger
                    </button>
                    <button class="demo-btn" onclick="showTriggerType('delete')">
                        üóëÔ∏è DELETE Trigger
                    </button>
                </div>

                <div class="demo-controls">
                    <button class="demo-btn" onclick="showTriggerCondition()">
                        üö¶ Trigger Condition
                    </button>
                    <button class="demo-btn clear-btn" onclick="resetTriggerDemo()">
                        üîÑ Demo Reset Karo
                    </button>
                </div>

                <!-- Trigger SQL Example -->
                <div class="code-block" id="triggerSqlCode">
                    <div class="code-line comment">/* Koi trigger type choose karo SQL example dekhne ke liye */</div>
                </div>

                <!-- Trigger Action Results -->
                <div class="demo-area" id="triggerActionOutput">
                    <div class="event-message one-message">
                        <div>Trigger ki action ka natija yahan dikhega...</div>
                    </div>
                </div>

                <!-- Trigger Benefits -->
                <div class="how-it-works">
                    <h4>üîç Triggers ke Fayde</h4>
                    <div class="step">
                        <div class="step-number">1</div>
                        <div>Repetitive tasks ko automate karo</div>
                    </div>
                    <div class="step">
                        <div class="step-number">2</div>
                        <div>Business rules ko enforce karo</div>
                    </div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <div>Audit logs maintain karo</div>
                    </div>
                    <div class="step">
                        <div class="step-number">4</div>
                        <div>Data ko consistent rakho</div>
                    </div>
                </div>
            </div>

            <!-- Gokuldham Analogy & Jethalal Style -->
            <div class="demo-section">
                <h2 class="demo-title">üè† Gokuldham Analogy</h2>
                
                <div class="explanation one-explanation">
                    <strong>Jethalal ka Style:</strong> Triggers ko real-world desi examples se samjhaate hain.
                </div>

                <!-- Analogy Display -->
                <div class="saree-analogy" id="triggerAnalogy">
                    <h4>Gokuldham Society ka Example</h4>
                    <div class="saree-step">
                        <div class="saree-emoji">üö™</div>
                        <div>Kisi table mein event (INSERT, UPDATE, DELETE) hone par trigger apne-aap kaam karta hai</div>
                    </div>
                    <div class="saree-step">
                        <div class="saree-emoji">üõéÔ∏è</div>
                        <div>Jaise Gokuldham mein doorbell (trigger), koi aayega toh apne-aap baj jayega ‚Äî tumhe manually check nahi karna padega</div>
                    </div>
                </div>

                <!-- Trigger Flow Visualization -->
                <div class="memory-diagram" id="triggerFlowDiagram">
                    <div class="memory-slot">
                        <div class="variable-name">Event (INSERT/UPDATE/DELETE)</div>
                        <div class="variable-value">Table mein data change hote hi</div>
                    </div>
                    <div class="memory-slot">
                        <div class="variable-name">Trigger Fires!</div>
                        <div class="variable-value">Automated action (notification, log, vagairah)</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tables & Mock Data -->
        <div class="demo-section">
            <h2 class="demo-title">üìù Order & Notification Tables (Mock Data)</h2>
            
            <div class="tabs">
                <button class="tab active" onclick="showTab('orders-tab')">Orders Table</button>
                <button class="tab" onclick="showTab('notifications-tab')">Notifications Table</button>
                <button class="tab" onclick="showTab('logs-tab')">Audit Logs Table</button>
            </div>

            <!-- Orders Table Tab -->
            <div id="orders-tab" class="tab-content active">
                <h4>üõí Orders Table</h4>
                <table class="responsive-table">
                    <thead>
                        <tr>
                            <th>OrderID</th>
                            <th>Customer</th>
                            <th>Amount</th>
                            <th>Status</th>
                            <th>Samay</th>
                        </tr>
                    </thead>
                    <tbody id="ordersTableBody">
                        <!-- Rows added by JavaScript -->
                    </tbody>
                </table>
                <div class="demo-controls" style="margin-top: 1rem;">
                    <button class="demo-btn first-btn" onclick="addOrder()">
                        ‚ûï Naya Order Add Karo (Insert)
                    </button>
                    <button class="demo-btn" onclick="updateOrder()">
                        ‚úèÔ∏è Order Update Karo
                    </button>
                    <button class="demo-btn clear-btn" onclick="deleteOrder()">
                        üóëÔ∏è Order Delete Karo
                    </button>
                </div>
            </div>

            <!-- Notifications Table Tab -->
            <div id="notifications-tab" class="tab-content">
                <h4>üì© Notifications Table</h4>
                <table class="responsive-table">
                    <thead>
                        <tr>
                            <th>NotificationID</th>
                            <th>Message</th>
                            <th>ForUser</th>
                            <th>Samay</th>
                        </tr>
                    </thead>
                    <tbody id="notificationsTableBody">
                        <!-- Rows added by JavaScript -->
                    </tbody>
                </table>
                <div class="explanation">
                    <strong>INSERT Trigger:</strong> Naye order aane par notification apne-aap add hota hai
                </div>
            </div>

            <!-- Audit Logs Table Tab -->
            <div id="logs-tab" class="tab-content">
                <h4>üìù Audit Logs Table</h4>
                <table class="responsive-table">
                    <thead>
                        <tr>
                            <th>LogID</th>
                            <th>Action</th>
                            <th>Details</th>
                            <th>Samay</th>
                        </tr>
                    </thead>
                    <tbody id="logsTableBody">
                        <!-- Rows added by JavaScript -->
                    </tbody>
                </table>
                <div class="explanation">
                    <strong>UPDATE/DELETE Trigger:</strong> Order mein change hua toh log apne-aap add hota hai
                </div>
            </div>
        </div>

        <!-- Jethalal-Bhide Conversation Section -->
        <div class="demo-section" style="grid-column: 1 / -1;">
            <h2 class="demo-title">üí¨ Jethalal aur Bhide ki Trigger wali Baat</h2>
            
            <div class="chat-input">
                <button class="demo-btn first-btn" onclick="startConversation()">
                    üé¨ Baat Shuru Karo
                </button>
                <button class="demo-btn" onclick="nextMessage()">
                    ‚û°Ô∏è Agla Message
                </button>
                <button class="demo-btn clear-btn" onclick="resetConversation()">
                    üîÑ Chat Reset Karo
                </button>
            </div>

            <div class="demo-area" id="conversationArea">
                <div class="event-message">
                    "Baat Shuru Karo" pe click karke Jethalal-Bhide ki Triggers wali charcha shuru karo!
                </div>
            </div>
        </div>

        <!-- Trigger Best Practices & Warnings -->
        <div class="comparison-section" id="triggerBestPractices">
            <h3>üìå Trigger ke Best Practices aur Warnings</h3>
            
            <table class="comparison-table responsive-table">
                <thead>
                    <tr>
                        <th>Aspect</th>
                        <th>‚úÖ Karo</th>
                        <th>‚ùå Mat Karo</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Istemal</strong></td>
                        <td>Notifications, Logs, Data Consistency</td>
                        <td>Complex Business Logic, Lambi Tasks</td>
                    </tr>
                    <tr>
                        <td><strong>Performance</strong></td>
                        <td>Fast, Idempotent actions</td>
                        <td>Heavy calculations, API calls, Nested Triggers</td>
                    </tr>
                    <tr>
                        <td><strong>Testing</strong></td>
                        <td>Realistic data ke saath test karo</td>
                        <td>Development mein ignore mat karo</td>
                    </tr>
                    <tr>
                        <td><strong>Monitoring</strong></td>
                        <td>Errors ke liye monitor karo</td>
                        <td>Bina dhyan ke chhod do</td>
                    </tr>
                </tbody>
            </table>
            <div class="explanation">
                <strong>Jethalal ki Salah:</strong> Trigger ko halki-phulki cheezon ke liye hi use karo. Nahi toh website ki performance ka band baj jayega!
            </div>
        </div>
    </div>

    <script>
        // Conversation data
        const conversation = [
            {
                speaker: "‡§≠‡§ø‡§°‡•á",
                message: "Jethalal! Meri website par naya order aate hi mujhe notification chahiye, lekin har baar manually check karna padta hai! Koi hal hai?",
                type: "one"
            },
            {
                speaker: "‡§ú‡•á‡§†‡§æ‡§≤‡§æ‡§≤",
                message: "Arre Bhide! Tu manually kyun jhak maar raha hai? Iske liye Database mein 'Trigger' laga ‚Äî jaise automatic alarm! Koi INSERT, UPDATE ya DELETE ho ‚Äî database khud action le lega!",
                type: "two"
            },
            {
                speaker: "‡§≠‡§ø‡§°‡•á",
                message: "Achha! Toh Trigger ek tarah ka watchdog hai? Yeh kaise tay karta hai ki kab aur kis table par react kare?",
                type: "one"
            },
            {
                speaker: "‡§ú‡•á‡§†‡§æ‡§≤‡§æ‡§≤",
                message: "Simple Bhide! Trigger ko set karta hai ‚Äî jaise 'AFTER INSERT ON Orders'. Matlab jaise hi naya order dalega, Trigger chal padega. Yeh notification bhej sakta hai, log bana sakta hai, ya doosri table update kar sakta hai.",
                type: "two"
            },
            {
                speaker: "‡§ú‡•á‡§†‡§æ‡§≤‡§æ‡§≤",
                message: "Agar condition lagani ho toh WHEN ya IF use kar ‚Äî jaise 'Order ‚Çπ1000 se zyada ho tabhi Trigger chale!' Yani Trigger soch-samajhkar active hoga, bina wajah nahi.",
                type: "two"
            },
            {
                speaker: "‡§≠‡§ø‡§°‡•á",
                message: "Lekin Jethalal, agar ek Trigger ke andar hum doosra Trigger chala dein toh?",
                type: "one"
            },
            {
                speaker: "‡§ú‡•á‡§†‡§æ‡§≤‡§æ‡§≤",
                message: "Arre Bhide, ise kehte hain 'Nested Triggers' ‚Äî aur haan, kuch databases ise allow karte hain! Lekin zyada chhedchhad ki toh system ki performance ka achar ban jayega! Isliye inhe samajhdari se istemal karna chahiye.",
                type: "two"
            },
            {
                speaker: "‡§≠‡§ø‡§°‡•á",
                message: "Agar ek saath 100 logon ne order kar diya toh?",
                type: "one"
            },
            {
                speaker: "‡§ú‡•á‡§†‡§æ‡§≤‡§æ‡§≤",
                message: "Trigger har insert par chalega ‚Äî yani 100 order aaye toh 100 baar trigger active hoga. Trigger koi jadu nahi, woh bhi resource leta hai. Isliye heavy logic mat daal usme ‚Äî notification bhejne jaisi light cheezein trigger se kar, lekin complex calculations, API calls, ya long-running kaam nahi.",
                type: "two"
            }
        ];

        let currentMessageIndex = 0;
        let currentTriggerType = null;
        let orders = [
            { id: 1, customer: 'Jethalal', amount: 1500, status: 'Pending', timestamp: new Date().toLocaleTimeString() },
            { id: 2, customer: 'Bhide', amount: 900, status: 'Processing', timestamp: new Date().toLocaleTimeString() },
            { id: 3, customer: 'Popatlal', amount: 2300, status: 'Shipped', timestamp: new Date().toLocaleTimeString() }
        ];
        let notifications = [];
        let logs = [];

        // Show specific trigger type example
        function showTriggerType(triggerType) {
            currentTriggerType = triggerType;
            let sql = '';
            let output = '';

            switch(triggerType) {
                case 'insert':
                    sql = `
CREATE OR REPLACE TRIGGER new_order_notification
AFTER INSERT ON Orders
FOR EACH ROW
BEGIN
    -- Ek notification bhejo
    INSERT INTO Notifications(message, forUser, time)
    VALUES ('Naya order #' || :new.id || ' mila!', 'Admin', SYSDATE);
END;
`;
                    output = "‚úÖ Trigger chalega jab bhi koi naya order aayega ‚Äî notification apne-aap ban jayega!";
                    break;
                case 'update':
                    sql = `
CREATE OR REPLACE TRIGGER order_status_changed
AFTER UPDATE ON Orders
FOR EACH ROW
WHEN (new.status != old.status)
BEGIN
    -- Audit log daalo
    INSERT INTO Logs(action, details, time)
    VALUES ('Status Badla', 'Order #' || :new.id || ' from ' || :old.status || ' to ' || :new.status, SYSDATE);
END;
`;
                    output = "‚úÖ Trigger chalega jab order ki status change hogi ‚Äî log apne-aap add ho jayega!";
                    break;
                case 'delete':
                    sql = `
CREATE OR REPLACE TRIGGER order_deleted
AFTER DELETE ON Orders
FOR EACH ROW
BEGIN
    -- Deletion log daalo
    INSERT INTO Logs(action, details, time)
    VALUES ('Order Delete Hua', 'Order #' || :old.id || ' delete ho gaya', SYSDATE);
END;
`;
                    output = "‚úÖ Trigger chalega jab koi order delete hoga ‚Äî log entry apne-aap ban jayegi!";
                    break;
            }

            document.getElementById('triggerSqlCode').innerHTML = `
                <div class="code-line comment">/* ${triggerType.toUpperCase()} Trigger ka Example */</div>
                ${sql.split('\n').map(line => `<div class="code-line">${line}</div>`).join('')}
                <div class="code-line comment">/* Niche "Add", "Update", ya "Delete" button try karo triggers in action dekhne ke liye! */</div>
            `;
            document.getElementById('triggerActionOutput').innerHTML = `
                <div class="event-message one-message">
                    ${output}
                </div>
            `;
        }

        // Show trigger with condition
        function showTriggerCondition() {
            currentTriggerType = 'condition';
            let sql = `
CREATE OR REPLACE TRIGGER high_value_order
AFTER INSERT ON Orders
FOR EACH ROW
WHEN (new.amount > 1000)
BEGIN
    INSERT INTO Notifications(message, forUser, time)
    VALUES ('High value order #' || :new.id || ' (' || :new.amount || ') mila!', 'Admin', SYSDATE);
END;
`;
            document.getElementById('triggerSqlCode').innerHTML = `
                <div class="code-line comment">/* Conditional INSERT Trigger ka Example */</div>
                ${sql.split('\n').map(line => `<div class="code-line">${line}</div>`).join('')}
                <div class="code-line comment">/* Yeh trigger tabhi chalega jab order amount ‚Çπ1000 se zyada ho! */</div>
            `;
            document.getElementById('triggerActionOutput').innerHTML = `
                <div class="event-message one-message">
                    ‚úÖ Trigger sirf tabhi chalega jab koi condition puri hogi (jaise amount > ‚Çπ1000).<br>
                    üôÖ‚Äç‚ôÇÔ∏è Chhota order hua toh trigger nahi chalega ‚Äî database par unnecessary load se bachayega!
                </div>
            `;
        }

        // Reset trigger demo
        function resetTriggerDemo() {
            currentTriggerType = null;
            document.getElementById('triggerSqlCode').innerHTML = `
                <div class="code-line comment">/* Koi trigger type choose karo SQL example dekhne ke liye */</div>
            `;
            document.getElementById('triggerActionOutput').innerHTML = `
                <div class="event-message one-message">
                    <div>Trigger ki action ka natija yahan dikhega...</div>
                </div>
            `;
        }

        // Tab functionality
        function showTab(tabName) {
            // Hide all tab contents
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.remove('active'));
            
            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        // Render tables
        function renderTables() {
            // Orders Table
            document.getElementById('ordersTableBody').innerHTML = '';
            orders.forEach(order => {
                document.getElementById('ordersTableBody').innerHTML += `
                    <tr>
                        <td>${order.id}</td>
                        <td>${order.customer}</td>
                        <td>‚Çπ${order.amount}</td>
                        <td>${order.status}</td>
                        <td>${order.timestamp}</td>
                    </tr>
                `;
            });
            
            // Notifications Table
            document.getElementById('notificationsTableBody').innerHTML = '';
            notifications.forEach(notif => {
                document.getElementById('notificationsTableBody').innerHTML += `
                    <tr>
                        <td>${notif.id}</td>
                        <td>${notif.message}</td>
                        <td>${notif.forUser}</td>
                        <td>${notif.time}</td>
                    </tr>
                `;
            });
            
            // Logs Table
            document.getElementById('logsTableBody').innerHTML = '';
            logs.forEach(log => {
                document.getElementById('logsTableBody').innerHTML += `
                    <tr>
                        <td>${log.id}</td>
                        <td>${log.action}</td>
                        <td>${log.details}</td>
                        <td>${log.time}</td>
                    </tr>
                `;
            });
        }

        // Add new order (fires INSERT trigger)
        function addOrder() {
            const newId = orders.length > 0 ? Math.max(...orders.map(o => o.id)) + 1 : 1;
            const customers = ['Jethalal', 'Bhide', 'Popatlal', 'Madhavi', 'Babita', 'Iyer', 'Tapu'];
            const customer = customers[Math.floor(Math.random() * customers.length)];
            const amount = Math.floor(500 + Math.random() * 2000);
            const status = 'Pending';
            const timestamp = new Date().toLocaleTimeString();
            
            orders.push({ id: newId, customer, amount, status, timestamp });
            
            // INSERT Trigger logic (simulated)
            const notifId = notifications.length > 0 ? Math.max(...notifications.map(n => n.id)) + 1 : 1;
            
            // Simulate conditional trigger (only if amount > 1000)
            if (amount > 1000) {
                notifications.push({
                    id: notifId,
                    message: `High value order #${newId} (‚Çπ${amount}) mila!`,
                    forUser: 'Admin',
                    time: timestamp
                });
                logs.push({
                    id: logs.length + 1,
                    action: 'Order Created (High Value)',
                    details: `Order #${newId} (‚Çπ${amount}) by ${customer}`,
                    time: timestamp
                });
            } else {
                notifications.push({
                    id: notifId,
                    message: `Naya order #${newId} mila!`,
                    forUser: 'Admin',
                    time: timestamp
                });
            }
            
            renderTables();
        }

        // Update order (fires UPDATE trigger)
        function updateOrder() {
            if (orders.length === 0) return;
            const orderIdx = Math.floor(Math.random() * orders.length);
            const order = orders[orderIdx];
            if (order.status === 'Pending') order.status = 'Processing';
            else if (order.status === 'Processing') order.status = 'Shipped';
            else if (order.status === 'Shipped') order.status = 'Delivered';
            order.timestamp = new Date().toLocaleTimeString();
            
            // UPDATE Trigger logic (simulated)
            logs.push({
                id: logs.length + 1,
                action: 'Status Badla',
                details: `Order #${order.id} ${order.status}`,
                time: order.timestamp
            });
            
            renderTables();
        }

        // Delete order (fires DELETE trigger)
        function deleteOrder() {
            if (orders.length === 0) return;
            const orderIdx = Math.floor(Math.random() * orders.length);
            const order = orders.splice(orderIdx, 1)[0];
            
            // DELETE Trigger logic (simulated)
            logs.push({
                id: logs.length + 1,
                action: 'Order Delete Hua',
                details: `Order #${order.id} by ${order.customer} (‚Çπ${order.amount}) delete ho gaya`,
                time: new Date().toLocaleTimeString()
            });
            
            renderTables();
        }

        // Conversation functions
        function startConversation() {
            currentMessageIndex = 0;
            showMessage();
        }

        function nextMessage() {
            if (currentMessageIndex < conversation.length - 1) {
                currentMessageIndex++;
                showMessage();
            }
        }

        function showMessage() {
            const message = conversation[currentMessageIndex];
            const conversationArea = document.getElementById('conversationArea');
            
            if (currentMessageIndex === 0) {
                conversationArea.innerHTML = '';
            }
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `event-message ${message.type}-message`;
            messageDiv.innerHTML = `
                <strong>${message.speaker}:</strong> ${message.message}
                <div class="message-time">${new Date().toLocaleTimeString()}</div>
            `;
            
            conversationArea.appendChild(messageDiv);
            conversationArea.scrollTop = conversationArea.scrollHeight;
        }

        function resetConversation() {
            currentMessageIndex = 0;
            document.getElementById('conversationArea').innerHTML = `
                <div class="event-message">
                    "Baat Shuru Karo" pe click karke Jethalal-Bhide ki Triggers wali charcha shuru karo!
                </div>
            `;
        }

        // Render default tables on load
        window.onload = function() {
            renderTables();
        };
    </script>
</body>
</html>