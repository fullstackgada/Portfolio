<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Immutability ka Funda - Fullstackgada Interactive Demo</title>
    <link rel="icon" type="image/png" href="/image/favicon.ico">
    <link rel="stylesheet" href="/interactive-demo.css">
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <div class="header-interactive" style="position:relative;">
        <h1>Immutability ka Funda</h1>
        <p>Understand how Immutability works with Fullstackgada</p>
       <div class="explore-diagrams-btn-wrapper">
            <a href="/interactive.html" class="explore-diagrams-btn">
                <img src="/image/plus-circle.svg" alt="Instagram icon"> More Diagrams
            </a>
        </div>
       <div class="follow-btn-wrapper">
            <a href="https://www.instagram.com/fullstackgada" target="_blank" class="follow-btn">
    <img src="/image/instagram.svg" alt="Instagram icon"> Follow for More
</a>
        </div>
    </div>

        <!-- Demo Grid -->
        <div class="demo-grid">
            <!-- Mutable vs Immutable Comparison -->
            <div class="demo-section">
                <h2 class="demo-title">‚ö†Ô∏è Mutable vs üîí Immutable Demo</h2>
                
                <div class="explanation">
                    <strong>Mutation ka Problem:</strong> Jab hum original data ko directly change karte hain, toh unexpected side effects ho sakte hain!
                </div>

                <!-- Current Object Display -->
                <div class="demo-area" id="objectDisplay">
                    <div class="event-message one-message">
                        <strong>Original User Object:</strong><br>
                        <code id="originalObject">{ name: "Jethalal", city: "Mumbai", age: 45 }</code>
                    </div>
                </div>

                <!-- Demo Controls -->
                <div class="demo-controls">
                    <button class="demo-btn" onclick="demonstrateMutation()">
                        ‚ö†Ô∏è Original ko Mutate Karo (Dangerous)
                    </button>
                    <button class="demo-btn first-btn" onclick="demonstrateImmutability()">
                        üîí Immutable Copy Banao (Safe)
                    </button>
                    <button class="demo-btn clear-btn" onclick="resetDemo()">
                        üîÑ Demo Reset Karo
                    </button>
                </div>

                <!-- Results Display -->
                <div class="server-simulation">
                    <h4>Operation ke Results:</h4>
                    <div class="server-log" id="operationResults">
                        Upar wala button click karo to see mutation vs immutability in action...
                    </div>
                </div>

                <!-- Love Letter Analogy -->
                <div class="saree-analogy">
                    <h4>üíå Love Letter wali Misal</h4>
                    <div class="saree-step">
                        <div class="saree-emoji">üíî</div>
                        <div><strong>Mutation:</strong> Jaise koi mere love letter mein "I love you Babita" ki jagah "I love you Iyer" likh de!</div>
                    </div>
                    <div class="saree-step">
                        <div class="saree-emoji">üíù</div>
                        <div><strong>Immutability:</strong> Original letter ko safe rakho aur naya letter likho!</div>
                    </div>
                </div>
            </div>

            <!-- Shopping Cart Example -->
            <div class="demo-section">
                <h2 class="demo-title">üõí Shopping Cart ka Example</h2>
                
                <div class="explanation one-explanation">
                    <strong>Use Case:</strong> Shopping cart mein items add karte waqt immutability kyun zaroori hai.
                </div>

                <!-- Cart Display -->
                <div class="demo-area" id="cartDisplay">
                    <div class="event-message one-message">
                        <strong>Abhi ka Cart:</strong><br>
                        <div id="currentCart">Khali Cart</div>
                    </div>
                </div>

                <!-- Add Items Controls -->
                <div class="demo-controls">
                    <button class="demo-btn" onclick="addItemMutable()">
                        ‚ö†Ô∏è Item Add Karo (Mutable Way)
                    </button>
                    <button class="demo-btn first-btn" onclick="addItemImmutable()">
                        üîí Item Add Karo (Immutable Way)
                    </button>
                    <button class="demo-btn" onclick="undoLastAction()">
                        ‚Ü©Ô∏è Pichla Action Undo Karo
                    </button>
                    <button class="demo-btn clear-btn" onclick="resetCart()">
                        üóëÔ∏è Cart Khali Karo
                    </button>
                </div>

                <!-- Cart History -->
                <div class="how-it-works">
                    <h4>üìä Cart ka History (Immutable ke Fayde)</h4>
                    <div id="cartHistory">
                        <div class="step">
                            <div class="step-number">0</div>
                            <div>Khali cart state</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Code Examples Section -->
        <div class="demo-section" style="grid-column: 1 / -1;">
            <h2 class="demo-title">üíª Code Examples - Mutable vs Immutable</h2>
            
            <div class="tabs">
                <button class="tab active" onclick="showCodeExample('mutation')">‚ö†Ô∏è Mutation ke Problems</button>
                <button class="tab" onclick="showCodeExample('immutable-objects')">üîí Immutable Objects</button>
                <button class="tab" onclick="showCodeExample('immutable-arrays')">üìã Immutable Arrays</button>
                <button class="tab" onclick="showCodeExample('functional-approach')">‚ö° Functional Approach</button>
            </div>

            <!-- Mutation Problems Tab -->
            <div id="mutation" class="tab-content active">
                <div class="code-container">
                    <div class="code-block">
                        <div class="code-line comment">// ‚ùå Dangerous: Direct Mutation</div>
                        <div class="code-line var-declaration">let user = { name: "Jethalal", city: "Mumbai" };</div>
                        <div class="code-line var-usage">let anotherRef = user; // Same object reference</div>
                        <div class="code-line"></div>
                        <div class="code-line var-assignment">user.city = "Delhi"; // Mutation!</div>
                        <div class="code-line"></div>
                        <div class="code-line comment">// Problem: Dono references par asar!</div>
                        <div class="code-line error">console.log(user.city);      // "Delhi"</div>
                        <div class="code-line error">console.log(anotherRef.city); // "Delhi" (Unexpected!)</div>
                    </div>
                    <div class="code-block">
                        <div class="code-line comment">// ‚ùå Array Mutation ka Problem</div>
                        <div class="code-line var-declaration">let cart = ["iPhone", "MacBook"];</div>
                        <div class="code-line var-usage">let backupCart = cart; // Same reference</div>
                        <div class="code-line"></div>
                        <div class="code-line var-assignment">cart.push("iPad"); // Mutation!</div>
                        <div class="code-line"></div>
                        <div class="code-line error">console.log(backupCart); // ["iPhone", "MacBook", "iPad"]</div>
                        <div class="code-line comment">// Original backup bhi change ho gaya!</div>
                    </div>
                </div>
            </div>

            <!-- Immutable Objects Tab -->
            <div id="immutable-objects" class="tab-content">
                <div class="code-container">
                    <div class="code-block">
                        <div class="code-line comment">// ‚úÖ Safe: Immutable Object Update</div>
                        <div class="code-line var-declaration">let user = { name: "Jethalal", city: "Mumbai", age: 45 };</div>
                        <div class="code-line"></div>
                        <div class="code-line comment">// Mutation ke bajaye nayi copy banaye</div>
                        <div class="code-line var-usage">let updatedUser = { ...user, city: "Delhi" };</div>
                        <div class="code-line"></div>
                        <div class="code-line var-declaration">console.log(user.city);        // "Mumbai" (Original safe)</div>
                        <div class="code-line var-declaration">console.log(updatedUser.city);  // "Delhi" (Nayi copy)</div>
                    </div>
                    <div class="code-block">
                        <div class="code-line comment">// ‚úÖ Object.assign() ka Use</div>
                        <div class="code-line var-declaration">let original = { name: "Babita", profession: "Teacher" };</div>
                        <div class="code-line"></div>
                        <div class="code-line var-usage">let updated = Object.assign({}, original, { profession: "Doctor" });</div>
                        <div class="code-line"></div>
                        <div class="code-line var-declaration">console.log(original.profession); // "Teacher" (Safe)</div>
                        <div class="code-line var-declaration">console.log(updated.profession);  // "Doctor" (Nayi)</div>
                    </div>
                </div>
            </div>

            <!-- Immutable Arrays Tab -->
            <div id="immutable-arrays" class="tab-content">
                <div class="code-container">
                    <div class="code-block">
                        <div class="code-line comment">// ‚úÖ Immutable Array Operations</div>
                        <div class="code-line var-declaration">let cart = ["iPhone", "MacBook"];</div>
                        <div class="code-line"></div>
                        <div class="code-line comment">// Item immutably add karo</div>
                        <div class="code-line var-usage">let newCart = [...cart, "iPad"];</div>
                        <div class="code-line"></div>
                        <div class="code-line comment">// Item immutably remove karo</div>
                        <div class="code-line var-usage">let filteredCart = cart.filter(item => item !== "MacBook");</div>
                        <div class="code-line"></div>
                        <div class="code-line var-declaration">console.log(cart);         // ["iPhone", "MacBook"] (Original safe)</div>
                        <div class="code-line var-declaration">console.log(newCart);      // ["iPhone", "MacBook", "iPad"]</div>
                        <div class="code-line var-declaration">console.log(filteredCart); // ["iPhone"]</div>
                    </div>
                    <div class="code-block">
                        <div class="code-line comment">// ‚úÖ Array item immutably update karo</div>
                        <div class="code-line var-declaration">let users = [</div>
                        <div class="code-line var-usage">  { id: 1, name: "Jethalal" },</div>
                        <div class="code-line var-usage">  { id: 2, name: "Bhide" }</div>
                        <div class="code-line var-declaration">];</div>
                        <div class="code-line"></div>
                        <div class="code-line var-usage">let updatedUsers = users.map(user => </div>
                        <div class="code-line var-usage">  user.id === 1 ? { ...user, name: "Jethalal Gada" } : user</div>
                        <div class="code-line var-usage">);</div>
                    </div>
                </div>
            </div>

            <!-- Functional Approach Tab -->
            <div id="functional-approach" class="tab-content">
                <div class="code-container">
                    <div class="code-block">
                        <div class="code-line comment">// ‚úÖ Pure Functions (No Side Effects)</div>
                        <div class="code-line var-declaration">function addToCart(cart, item) {</div>
                        <div class="code-line var-usage">  return [...cart, item]; // Nayi array return karta hai</div>
                        <div class="code-line var-declaration">}</div>
                        <div class="code-line"></div>
                        <div class="code-line var-declaration">function updateUser(user, updates) {</div>
                        <div class="code-line var-usage">  return { ...user, ...updates }; // Naya object return karta hai</div>
                        <div class="code-line var-declaration">}</div>
                        <div class="code-line"></div>
                        <div class="code-line comment">// Usage</div>
                        <div class="code-line var-usage">let cart = ["iPhone"];</div>
                        <div class="code-line var-usage">let newCart = addToCart(cart, "MacBook");</div>
                        <div class="code-line var-declaration">// Original cart wahi ka wahi!</div>
                    </div>
                    <div class="code-block">
                        <div class="code-line comment">// ‚úÖ Reducer Pattern (Redux Style)</div>
                        <div class="code-line var-declaration">function cartReducer(state, action) {</div>
                        <div class="code-line var-usage">  switch(action.type) {</div>
                        <div class="code-line var-usage">    case 'ADD_ITEM':</div>
                        <div class="code-line var-usage">      return { ...state, items: [...state.items, action.item] };</div>
                        <div class="code-line var-usage">    case 'REMOVE_ITEM':</div>
                        <div class="code-line var-usage">      return { ...state, items: state.items.filter(item => item.id !== action.id) };</div>
                        <div class="code-line var-usage">    default:</div>
                        <div class="code-line var-usage">      return state; // Hamesha state return karo</div>
                        <div class="code-line var-usage">  }</div>
                        <div class="code-line var-declaration">}</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Benefits & Trade-offs Section -->
        <div class="comparison-section">
            <h3>‚öñÔ∏è Immutability: Fayde vs Trade-offs</h3>
            
            <table class="comparison-table responsive-table">
                <thead>
                    <tr>
                        <th>Aspect</th>
                        <th>‚úÖ Fayde</th>
                        <th>‚ö†Ô∏è Trade-offs</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Predictability</strong></td>
                        <td>Koi unexpected side effects nahi, debugging asaan</td>
                        <td>Code thoda verbose, extra copying</td>
                    </tr>
                    <tr>
                        <td><strong>Time Travel</strong></td>
                        <td>Undo/Redo features, state history track karna</td>
                        <td>History ke saath memory use badhta hai</td>
                    </tr>
                    <tr>
                        <td><strong>Concurrency</strong></td>
                        <td>Thread-safe, koi race conditions nahi</td>
                        <td>Deep copying ke liye performance overhead</td>
                    </tr>
                    <tr>
                        <td><strong>Testing</strong></td>
                        <td>Pure functions ko test karna asaan</td>
                        <td>Immutable patterns ko sahi se test karna padta hai</td>
                    </tr>
                    <tr>
                        <td><strong>Performance</strong></td>
                        <td>Structural sharing, memoization possible</td>
                        <td>Copying ke liye initial performance cost</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
      
        let originalUser = { name: "Jethalal", city: "Mumbai", age: 45 };
        let currentCart = [];
        let cartHistory = [[]];
        let historyIndex = 0;

        // Demonstrate mutation problems
        function demonstrateMutation() {
            // Create references to same object
            let user1 = { ...originalUser };
            let user2 = user1; // Same reference!
            
            // Mutate the object
            user1.city = "Delhi";
            user1.age = 46;
            
            document.getElementById('operationResults').innerHTML = `
                <strong style="color: #f56565;">‚ö†Ô∏è Mutation ka Problem Dikhaya!</strong><br>
                Original object ko directly modify kiya gaya:<br>
                <code>user1.city = "Delhi";</code><br>
                <code>user2</code> (jo same object ko point karta tha) bhi affect hua!<br><br>
                <strong>Result:</strong><br>
                user1: { name: "Jethalal", city: "Delhi", age: 46 }<br>
                user2: { name: "Jethalal", city: "Delhi", age: 46 } (Unexpected!)
            `;
        }

        // Demonstrate immutability
        function demonstrateImmutability() {
            // Create immutable copy
            let originalUser = { name: "Jethalal", city: "Mumbai", age: 45 };
            let updatedUser = { ...originalUser, city: "Delhi", age: 46 };
            
            document.getElementById('operationResults').innerHTML = `
                <strong style="color: #4caf50;">‚úÖ Immutability Success!</strong><br>
                Original modify kiye bina naya object banaya:<br>
                <code>let updatedUser = { ...originalUser, city: "Delhi", age: 46 };</code><br><br>
                <strong>Result:</strong><br>
                original: { name: "Jethalal", city: "Mumbai", age: 45 } (Safe!)<br>
                updated: { name: "Jethalal", city: "Delhi", age: 46 } (Nayi copy)
            `;
        }

        // Reset demo
        function resetDemo() {
            document.getElementById('operationResults').innerHTML = 'Upar wala button click karo to see mutation vs immutability in action...';
            document.getElementById('originalObject').textContent = '{ name: "Jethalal", city: "Mumbai", age: 45 }';
        }

        // Add item with mutation (bad way)
        function addItemMutable() {
            const items = ["iPhone", "MacBook", "iPad", "AirPods", "Apple Watch"];
            const randomItem = items[Math.floor(Math.random() * items.length)];
            
            // Directly mutate current cart (bad!)
            currentCart.push(randomItem);
            
            updateCartDisplay();
            
            // Show warning about mutation
            setTimeout(() => {
                alert("‚ö†Ô∏è Warning: Direct mutation ho gaya! Pichla state hamesha ke liye gayab.");
            }, 500);
        }

        // Add item immutably (good way)
        function addItemImmutable() {
            const items = ["iPhone", "MacBook", "iPad", "AirPods", "Apple Watch"];
            const randomItem = items[Math.floor(Math.random() * items.length)];
            
            // Create new cart immutably
            currentCart = [...currentCart, randomItem];
            
            // Save to history for undo functionality
            cartHistory = cartHistory.slice(0, historyIndex + 1);
            cartHistory.push([...currentCart]);
            historyIndex++;
            
            updateCartDisplay();
            updateCartHistory();
        }

        // Undo last action (only possible with immutability)
        function undoLastAction() {
            if (historyIndex > 0) {
                historyIndex--;
                currentCart = [...cartHistory[historyIndex]];
                updateCartDisplay();
                updateCartHistory();
            } else {
                alert("Undo karne ke liye kuch nahi hai!");
            }
        }

        // Reset cart
        function resetCart() {
            currentCart = [];
            cartHistory = [[]];
            historyIndex = 0;
            updateCartDisplay();
            updateCartHistory();
        }

        // Update cart display
        function updateCartDisplay() {
            const cartDiv = document.getElementById('currentCart');
            if (currentCart.length === 0) {
                cartDiv.innerHTML = 'Khali Cart';
            } else {
                cartDiv.innerHTML = currentCart.map((item, index) => 
                    `<div style="padding: 0.2rem; background: #f0f0f0; margin: 0.2rem 0; border-radius: 4px;">
                        ${index + 1}. ${item}
                    </div>`
                ).join('');
            }
        }

        // Update cart history display
        function updateCartHistory() {
            const historyDiv = document.getElementById('cartHistory');
            historyDiv.innerHTML = cartHistory.map((cart, index) => {
                const isActive = index === historyIndex;
                return `
                    <div class="step ${isActive ? 'active' : ''}">
                        <div class="step-number">${index}</div>
                        <div>
                            ${cart.length === 0 ? 'Khali cart' : `Cart: [${cart.join(', ')}]`}
                            ${isActive ? ' (Abhi ka)' : ''}
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Show code examples
        function showCodeExample(exampleType) {
            // Hide all tab contents
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.remove('active'));
            
            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Show selected tab content
            document.getElementById(exampleType).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        // Initialize demo
        window.onload = function() {
            resetDemo();
            updateCartDisplay();
            updateCartHistory();
        };
    </script>
</body>
</html>