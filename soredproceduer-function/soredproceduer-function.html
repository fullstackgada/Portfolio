<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stored Procedure vs Function - Working Demo</title>
    <link rel="stylesheet" href="/interactive-demo.css">
</head>
<body>
    <div class="container">
        <!-- Updated Header with your existing CSS class -->
        <div class="header-interactive">
            <h1>üè™ Stored Procedure vs Function - Working Demo</h1>
            <p>‡§≠‡§ø‡§°‡•á ‡§î‡§∞ ‡§ú‡•á‡§†‡§æ‡§≤‡§æ‡§≤ ‡§ï‡•á ‡§∏‡§æ‡§• Live Database Experience</p>
        </div>
        
        <!-- Updated Navigation with your existing CSS class -->
        <div class="tabs">
            <button class="tab active" onclick="showTab('database')" role="tab" aria-label="‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏ ‡§ü‡•à‡§¨">üóÑÔ∏è Database</button>
            <button class="tab" onclick="showTab('procedure')" role="tab" aria-label="‡§™‡•ç‡§∞‡•ã‡§∏‡•Ä‡§ú‡§∞ ‡§°‡•á‡§Æ‡•ã ‡§ü‡•à‡§¨">üîß Procedure Demo</button>
            <button class="tab" onclick="showTab('function')" role="tab" aria-label="‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ‡§°‡•á‡§Æ‡•ã ‡§ü‡•à‡§¨">‚ö° Function Demo</button>
            <button class="tab" onclick="showTab('performance')" role="tab" aria-label="‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§® ‡§ü‡•à‡§¨">üìä Performance</button>
        </div>
        
    
        <!-- Database Tab -->
        <div id="database" class="tab-content active">
            <div class="demo-section">
                <h2 class="demo-title">üè¶ Bank Database Tables</h2>
                <div class="explanation">‡§Ø‡§π‡§æ‡§Å ‡§π‡§Æ‡§æ‡§∞‡•á demo database ‡§ï‡•á tables ‡§π‡•à‡§Ç:</div>
            </div>
            
            <div class="demo-grid">
                <div class="demo-section">
                    <h3>üë• Accounts Table</h3>
                    <table class="responsive-table" id="accountsTable">
                        <thead>
                            <tr>
                                <th>Account ID</th>
                                <th>Name</th>
                                <th>Balance</th>
                                <th>Type</th>
                            </tr>
                        </thead>
                        <tbody id="accountsData">
                            <!-- Data will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
                
                <div class="demo-section">
                    <h3>üíº Employees Table</h3>
                    <table class="responsive-table" id="employeesTable">
                        <thead>
                            <tr>
                                <th>Employee ID</th>
                                <th>Name</th>
                                <th>Salary</th>
                                <th>Performance</th>
                            </tr>
                        </thead>
                        <tbody id="employeesData">
                            <!-- Data will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="demo-section">
                <h3>üìä Transaction History</h3>
                <table class="responsive-table" id="transactionsTable">
                    <thead>
                        <tr>
                            <th>Transaction ID</th>
                            <th>From Account</th>
                            <th>To Account</th>
                            <th>Amount</th>
                            <th>Status</th>
                            <th>Timestamp</th>
                        </tr>
                    </thead>
                    <tbody id="transactionsData">
                        <!-- Data will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Procedure Demo Tab -->
        <div id="procedure" class="tab-content">
            <div class="demo-section">
                <h2 class="demo-title">üîß Stored Procedure Demo - Money Transfer</h2>
                <div class="explanation">‡§Ø‡§π‡§æ‡§Å ‡§Ü‡§™ actual money transfer procedure ‡§ï‡•ã run ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:</div>
            </div>
            
            <div class="demo-grid">
                <div class="demo-section">
                    <h3>üí∞ Transfer Money</h3>
                    <div class="form-group">
                        <label>From Account:</label>
                        <select id="fromAccount">
                            <option value="1">Account 1 - ‡§ú‡•á‡§†‡§æ‡§≤‡§æ‡§≤</option>
                            <option value="2">Account 2 - ‡§≠‡§ø‡§°‡•á</option>
                            <option value="3">Account 3 - ‡§§‡§æ‡§∞‡§ï</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>To Account:</label>
                        <select id="toAccount">
                            <option value="1">Account 1 - ‡§ú‡•á‡§†‡§æ‡§≤‡§æ‡§≤</option>
                            <option value="2">Account 2 - ‡§≠‡§ø‡§°‡•á</option>
                            <option value="3">Account 3 - ‡§§‡§æ‡§∞‡§ï</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Amount (‚Çπ):</label>
                        <input type="number" id="transferAmount" placeholder="‡§∞‡§æ‡§∂‡§ø ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç" min="1" max="100000">
                    </div>
                    <div class="demo-controls">
                        <button class="demo-btn" onclick="executeTransfer()">
                            üí∏ Execute Transfer <span class="performance-indicator fast">Fast</span>
                        </button>
                    </div>
                </div>
                
                <div class="demo-section">
                    <h3>üìù Stored Procedure Code</h3>
                    <div class="code-block">
CREATE PROCEDURE TransferMoney(
    @FromAccount INT,
    @ToAccount INT,
    @Amount DECIMAL(10,2)
)
AS
BEGIN
    BEGIN TRANSACTION
    
    DECLARE @FromBalance DECIMAL(10,2)
    SELECT @FromBalance = Balance 
    FROM Accounts 
    WHERE AccountID = @FromAccount
    
    IF @FromBalance >= @Amount
    BEGIN
        UPDATE Accounts 
        SET Balance = Balance - @Amount 
        WHERE AccountID = @FromAccount
        
        UPDATE Accounts 
        SET Balance = Balance + @Amount 
        WHERE AccountID = @ToAccount
        
        INSERT INTO Transactions VALUES(
            @FromAccount, @ToAccount, 
            @Amount, 'Success', GETDATE()
        )
        
        COMMIT TRANSACTION
        RETURN 1 -- Success
    END
    ELSE
    BEGIN
        ROLLBACK TRANSACTION
        RETURN 0 -- Failed
    END
END
                    </div>
                </div>
            </div>
            
            <div class="demo-area" id="procedureResult">
                <p>Execute transfer ‡§ï‡•ã click ‡§ï‡§∞‡•á‡§Ç procedure run ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è...</p>
            </div>
        </div>
        
        <!-- Function Demo Tab -->
        <div id="function" class="tab-content">
            <div class="demo-section">
                <h2 class="demo-title">‚ö° Function Demo - Bonus Calculator</h2>
                <div class="explanation">‡§Ø‡§π‡§æ‡§Å ‡§Ü‡§™ employee bonus calculate ‡§ï‡§∞‡§®‡•á ‡§µ‡§æ‡§≤‡§æ function try ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç:</div>
            </div>
            
            <div class="demo-grid">
                <div class="demo-section">
                    <h3>üéØ Calculate Bonus</h3>
                    <div class="form-group">
                        <label>Select Employee:</label>
                        <select id="employeeSelect">
                            <option value="1">Employee 1 - ‡§ú‡•á‡§†‡§æ‡§≤‡§æ‡§≤</option>
                            <option value="2">Employee 2 - ‡§≠‡§ø‡§°‡•á</option>
                            <option value="3">Employee 3 - ‡§§‡§æ‡§∞‡§ï</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Performance Score (0-100):</label>
                        <input type="number" id="performanceScore" placeholder="‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§® ‡§∏‡•ç‡§ï‡•ã‡§∞ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç" min="0" max="100">
                    </div>
                    <div class="demo-controls">
                        <button class="demo-btn" onclick="calculateBonus()">
                            üéâ Calculate Bonus <span class="performance-indicator fast">Fast</span>
                        </button>
                    </div>
                </div>
                
                <div class="demo-section">
                    <h3>üìù Function Code</h3>
                    <div class="code-block">
CREATE FUNCTION CalculateBonus(
    @Salary DECIMAL(10,2), 
    @Performance INT
)
RETURNS DECIMAL(10,2)
AS
BEGIN
    DECLARE @Bonus DECIMAL(10,2)
    
    IF @Performance >= 90
        SET @Bonus = @Salary * 0.20      -- 20%
    ELSE IF @Performance >= 80
        SET @Bonus = @Salary * 0.15      -- 15%
    ELSE IF @Performance >= 70
        SET @Bonus = @Salary * 0.10      -- 10%
    ELSE IF @Performance >= 60
        SET @Bonus = @Salary * 0.05      -- 5%
    ELSE
        SET @Bonus = 0                   -- No bonus
    
    RETURN @Bonus
END


-- Usage Example:
SELECT Name, Salary, 
       dbo.CalculateBonus(Salary, Performance) as Bonus
FROM Employees
                    </div>
                </div>
            </div>
            
            <div class="demo-area" id="functionResult">
                <p>Calculate Bonus ‡§ï‡•ã click ‡§ï‡§∞‡•á‡§Ç function run ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è...</p>
            </div>
            
            <div class="demo-section">
                <h3>üìä All Employees Bonus Report</h3>
                <div class="demo-controls">
                    <button class="demo-btn" onclick="generateBonusReport()">
                        üìã Generate Report <span class="performance-indicator medium">Medium</span>
                    </button>
                </div>
                <div id="bonusReportTable" style="margin-top: 20px;"></div>
            </div>
        </div>
        
        <!-- Performance Tab -->
        <div id="performance" class="tab-content">
            <div class="demo-section">
                <h2 class="demo-title">üìä Performance Comparison</h2>
                <div class="explanation">‡§¶‡•á‡§ñ‡§ø‡§è ‡§ï‡§ø Stored Procedure ‡§î‡§∞ Function ‡§ï‡§ø‡§§‡§®‡•á fast ‡§π‡•à‡§Ç:</div>
            </div>
            
            <div class="comparison-metrics">
                <div class="metric-card">
                    <h4>Regular Query</h4>
                    <div class="metric-value" id="regularQueryTime">2.5s</div>
                    <div class="metric-label">Average Execution Time</div>
                    <span class="performance-indicator slow">Slow</span>
                </div>
                
                <div class="metric-card">
                    <h4>Function</h4>
                    <div class="metric-value" id="functionTime">1.8s</div>
                    <div class="metric-label">Average Execution Time</div>
                    <span class="performance-indicator medium">Medium</span>
                </div>
                
                <div class="metric-card">
                    <h4>Stored Procedure</h4>
                    <div class="metric-value" id="procedureTime">1.2s</div>
                    <div class="metric-label">Average Execution Time</div>
                    <span class="performance-indicator fast">Fast</span>
                </div>
            </div>
            
            <div class="demo-section">
                <h3>üß™ Performance Test</h3>
                <p>Click ‡§ï‡§∞‡•á‡§Ç live performance test run ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è:</p>
                <div class="demo-controls">
                    <button class="demo-btn" onclick="runPerformanceTest()">
                        üöÄ Run Performance Test
                    </button>
                </div>
                <div class="demo-area" id="performanceResult">
                    <p>Performance test ‡§ï‡•á results ‡§Ø‡§π‡§æ‡§Å ‡§Ü‡§è‡§Ç‡§ó‡•á...</p>
                </div>
            </div>
          
        </div>
    </div>
    
    <script>
        // Simulated Database Data
        let accountsData = [
            { id: 1, name: '‡§ú‡•á‡§†‡§æ‡§≤‡§æ‡§≤', balance: 50000, type: 'Savings' },
            { id: 2, name: '‡§≠‡§ø‡§°‡•á', balance: 25000, type: 'Current' },
            { id: 3, name: '‡§§‡§æ‡§∞‡§ï', balance: 75000, type: 'Savings' }
        ];
        
        let employeesData = [
            { id: 1, name: '‡§ú‡•á‡§†‡§æ‡§≤‡§æ‡§≤', salary: 50000, performance: 85 },
            { id: 2, name: '‡§≠‡§ø‡§°‡•á', salary: 40000, performance: 92 },
            { id: 3, name: '‡§§‡§æ‡§∞‡§ï', salary: 60000, performance: 78 }
        ];
        
        let transactionsData = [
            { id: 1, from: 1, to: 2, amount: 5000, status: 'Success', timestamp: '2024-01-15 10:30' },
            { id: 2, from: 2, to: 3, amount: 3000, status: 'Success', timestamp: '2024-01-15 11:45' }
        ];
        
        let transactionCounter = 3;
        
        function showTab(tabName) {
            // Hide all content
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.remove('active'));
            
            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Show selected content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
            
            // Load data when database tab is shown
            if (tabName === 'database') {
                loadDatabaseTables();
            }
        }
        
        function loadDatabaseTables() {
            // Load Accounts Table
            const accountsTableBody = document.getElementById('accountsData');
            accountsTableBody.innerHTML = '';
            accountsData.forEach(account => {
                const row = accountsTableBody.insertRow();
                row.innerHTML = `
                    <td>${account.id}</td>
                    <td>${account.name}</td>
                    <td>‚Çπ${account.balance.toLocaleString()}</td>
                    <td>${account.type}</td>
                `;
            });
            
            // Load Employees Table
            const employeesTableBody = document.getElementById('employeesData');
            employeesTableBody.innerHTML = '';
            employeesData.forEach(employee => {
                const row = employeesTableBody.insertRow();
                row.innerHTML = `
                    <td>${employee.id}</td>
                    <td>${employee.name}</td>
                    <td>‚Çπ${employee.salary.toLocaleString()}</td>
                    <td>${employee.performance}</td>
                `;
            });
            
            // Load Transactions Table
            const transactionsTableBody = document.getElementById('transactionsData');
            transactionsTableBody.innerHTML = '';
            transactionsData.forEach(transaction => {
                const row = transactionsTableBody.insertRow();
                row.innerHTML = `
                    <td>${transaction.id}</td>
                    <td>${transaction.from}</td>
                    <td>${transaction.to}</td>
                    <td>‚Çπ${transaction.amount.toLocaleString()}</td>
                    <td>${transaction.status}</td>
                    <td>${transaction.timestamp}</td>
                `;
            });
        }
        
        function executeTransfer() {
            const fromAccount = parseInt(document.getElementById('fromAccount').value);
            const toAccount = parseInt(document.getElementById('toAccount').value);
            const amount = parseFloat(document.getElementById('transferAmount').value);
            const resultPanel = document.getElementById('procedureResult');
            
            // Input validation
            if (fromAccount === toAccount) {
                resultPanel.innerHTML = '<p class="error-message">Error: From and To accounts cannot be the same!</p>';
                return;
            }
            if (isNaN(amount) || amount <= 0 || amount > 100000) {
                resultPanel.innerHTML = '<p class="error-message">Error: Please enter a valid amount (1-100,000)!</p>';
                return;
            }
            
            // Simulate stored procedure
            const fromAccountData = accountsData.find(acc => acc.id === fromAccount);
            if (fromAccountData.balance >= amount) {
                fromAccountData.balance -= amount;
                const toAccountData = accountsData.find(acc => acc.id === toAccount);
                toAccountData.balance += amount;
                
                transactionsData.push({
                    id: transactionCounter++,
                    from: fromAccount,
                    to: toAccount,
                    amount: amount,
                    status: 'Success',
                    timestamp: new Date().toLocaleString()
                });
                
                resultPanel.innerHTML = `<p class="success-message">Success: ‚Çπ${amount.toLocaleString()} transferred from Account ${fromAccount} to Account ${toAccount}!</p>`;
            } else {
                resultPanel.innerHTML = `<p class="error-message">Error: Insufficient balance in Account ${fromAccount}!</p>`;
            }
            
            // Refresh database tables
            loadDatabaseTables();
        }
        
        function calculateBonus() {
            const employeeId = parseInt(document.getElementById('employeeSelect').value);
            const performance = parseInt(document.getElementById('performanceScore').value);
            const resultPanel = document.getElementById('functionResult');
            
            // Input validation
            if (isNaN(performance) || performance < 0 || performance > 100) {
                resultPanel.innerHTML = '<p class="error-message">Error: Please enter a valid performance score (0-100)!</p>';
                return;
            }
            
            // Simulate function
            const employee = employeesData.find(emp => emp.id === employeeId);
            let bonus = 0;
            if (performance >= 90) {
                bonus = employee.salary * 0.20;
            } else if (performance >= 80) {
                bonus = employee.salary * 0.15;
            } else if (performance >= 70) {
                bonus = employee.salary * 0.10;
            } else if (performance >= 60) {
                bonus = employee.salary * 0.05;
            }
            
            resultPanel.innerHTML = `<p class="success-message">Bonus for ${employee.name}: ‚Çπ${bonus.toLocaleString()}</p>`;
        }
        
        function generateBonusReport() {
            const reportTable = document.getElementById('bonusReportTable');
            reportTable.innerHTML = `
                <table class="responsive-table">
                    <thead>
                        <tr>
                            <th>Employee ID</th>
                            <th>Name</th>
                            <th>Salary</th>
                            <th>Performance</th>
                            <th>Bonus</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${employeesData.map(emp => {
                            let bonus = 0;
                            if (emp.performance >= 90) {
                                bonus = emp.salary * 0.20;
                            } else if (emp.performance >= 80) {
                                bonus = emp.salary * 0.15;
                            } else if (emp.performance >= 70) {
                                bonus = emp.salary * 0.10;
                            } else if (emp.performance >= 60) {
                                bonus = emp.salary * 0.05;
                            }
                            return `
                                <tr>
                                    <td>${emp.id}</td>
                                    <td>${emp.name}</td>
                                    <td>‚Çπ${emp.salary.toLocaleString()}</td>
                                    <td>${emp.performance}</td>
                                    <td>‚Çπ${bonus.toLocaleString()}</td>
                                </tr>
                            `;
                        }).join('')}
                    </tbody>
                </table>
            `;
        }
        
        function runPerformanceTest() {
            const resultPanel = document.getElementById('performanceResult');
            
            // Simulate performance test with random times
            const regularQueryTime = (Math.random() * 0.5 + 2).toFixed(2);
            const functionTime = (Math.random() * 0.4 + 1.5).toFixed(2);
            const procedureTime = (Math.random() * 0.3 + 1).toFixed(2);
            
            document.getElementById('regularQueryTime').textContent = `${regularQueryTime}s`;
            document.getElementById('functionTime').textContent = `${functionTime}s`;
            document.getElementById('procedureTime').textContent = `${procedureTime}s`;
            
            resultPanel.innerHTML = `
                <p class="success-message">Performance Test Results:</p>
                <p>Regular Query: ${regularQueryTime}s</p>
                <p>Function: ${functionTime}s</p>
                <p>Stored Procedure: ${procedureTime}s</p>
            `;
        }
        
        // Initialize database tables on page load
        loadDatabaseTables();
    </script>
</body>
</html>
